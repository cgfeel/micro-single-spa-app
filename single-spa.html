<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="app_1"></div>
    <div id="app_2"></div>
    <script src="https://cdn.bootcdn.net/ajax/libs/single-spa/5.9.3/umd/single-spa.min.js"></script>
    <script>
        // 微前端就是可以加载不同的应用，single-spa 是基于路由的微前端
        // 如何接入已经写好的应用，对于 single-spa 而言我们需要改写子应用（接入协议：bootstrap, mount, unmount）

        const { registerApplication, start } = singleSpa;

        const app1 = {
            bootstrap: [
                async () => console.log("app1 bootstrap1"),
                async () => console.log("app1 bootstrap2"),
            ],
            // mount 也可以挂载数组，通常为一个异步函数
            // 在 single-spa 中是通过 `System.import<LifeCycles>("")` 返回一个 `promise`
            mount: [
                async () => {
                    // new Vue().$mount()...
                    console.log("app1 mount1");
                },
                async () => {
                    app_1.innerHTML = "<h1>APP1</h1>";
                }
            ],
            async unmount() {
                console.log("app1 unmount");
                app_1.innerHTML = "";
            }
        };

        const app2 = {
            bootstrap: async () => console.log("app2 bootstrap1"),
            async mount() {
                console.log("app2 mount1");
                app_2.innerHTML = "<h1>APP2</h1>";
            },
            async unmount() {
                console.log("app2 unmount");
                app_2.innerHTML = "";
            }
        };

        // 当路径是 #/app1 的时候加载应用 app1 
        registerApplication("app1", async () => app1, location => location.hash.startsWith("#/app1"));
        registerApplication("app2", async () => app2, location => location.hash.startsWith("#/app2"));

        start();
    </script>
</body>
</html>